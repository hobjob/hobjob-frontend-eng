import React from "react";
import {useDispatch} from "react-redux";

import {useTypedSelector} from "../../../hooks/useTypedSelector";

import {uploadScreenshot} from "../../../redux/actions/user";

const TrainingPaymentUploadScreenshot: React.FC = () => {
    const dispatch = useDispatch();

    const {userInfo} = useTypedSelector(({user}) => user);

    const handleSubmit = (e: React.ChangeEvent<HTMLInputElement>) => {
        if (e.target.files) {
            const size = e.target.files[0].size;

            if (size < 5000000) {
                let formData = new FormData();

                formData.append("screenshot", e.target.files[0]);

                dispatch(uploadScreenshot(formData));
            } else {
            }
        }
    };

    return (
        <div className="training-payment-text-image">
            {userInfo.screenshot !== "" ? (
                <>
                    <div className="training-payment-text-image-confirmed">
                        <label className="btn-regular training-payment-text-image-confirmed__btn">
                            <input
                                type="file"
                                name="screenshot"
                                onChange={handleSubmit}
                                multiple={false}
                            />
                            <svg
                                width="15"
                                height="20"
                                viewBox="0 0 15 20"
                                fill="none"
                                xmlns="http://www.w3.org/2000/svg"
                            >
                                <path
                                    d="M13.3696 8.15588C13.4551 8.24926 13.5586 8.32433 13.6739 8.37664C13.7892 8.42896 13.9139 8.45738 14.0405 8.46023C14.1671 8.46308 14.293 8.44031 14.4105 8.39324C14.5281 8.34616 14.6349 8.27576 14.7245 8.18632C14.8141 8.09688 14.8847 7.99029 14.932 7.87285C14.9794 7.7554 15.0024 7.62955 14.9998 7.50295C14.9972 7.37636 14.9691 7.25158 14.917 7.13616C14.8649 7.02074 14.79 6.91709 14.6968 6.83137L8.15325 0.273698L8.13777 0.26097C8.09883 0.223337 8.05691 0.188939 8.01238 0.158113C7.99829 0.14825 7.98132 0.142659 7.96723 0.134205C7.93028 0.110749 7.89171 0.090019 7.85173 0.0721977C7.82778 0.0623344 7.80241 0.0567106 7.77846 0.0496654C7.68837 0.0159749 7.59281 -0.000793911 7.49663 0.000300738C7.40046 -0.00246058 7.30467 0.0138159 7.21481 0.0482034C7.18804 0.0566576 7.15993 0.0623014 7.13457 0.0735737C7.10921 0.0848461 7.06968 0.107406 7.03868 0.124314C7.00768 0.141223 6.99505 0.145484 6.97392 0.159575C6.92351 0.193166 6.87629 0.231366 6.83296 0.273698L0.27529 6.81864C0.0992768 6.99428 0.000264777 7.23271 5.30097e-07 7.48137C-0.000263717 7.73002 0.0982745 7.9686 0.273914 8.14461C0.449554 8.32062 0.687897 8.41963 0.936553 8.4199C1.18521 8.42016 1.42378 8.32162 1.59979 8.14599L6.55544 3.20023L6.5385 18.9533C6.53831 19.0765 6.56244 19.1985 6.60945 19.3124C6.65645 19.4262 6.72538 19.5297 6.81241 19.6168C6.89944 19.704 7.00282 19.7731 7.1166 19.8203C7.23037 19.8675 7.35231 19.8918 7.47548 19.8918C7.72387 19.8914 7.96204 19.7925 8.13769 19.6169C8.31333 19.4413 8.41217 19.2032 8.41255 18.9548L8.4294 3.20169L13.3696 8.15588Z"
                                    fill="#F4906E"
                                />
                            </svg>
                            Change
                        </label>
                    </div>

                    <img
                        className="training-payment-text-image__upload"
                        src={`${process.env.REACT_APP_IMAGE_DOMEN}/${userInfo.screenshot}`}
                        alt=""
                    />
                </>
            ) : (
                <label className="btn-regular training-payment-text-image__btn">
                    <input
                        type="file"
                        name="screenshot"
                        onChange={handleSubmit}
                        multiple={false}
                    />
                    <svg
                        width="15"
                        height="20"
                        viewBox="0 0 15 20"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                    >
                        <path
                            d="M13.3696 8.15588C13.4551 8.24926 13.5586 8.32433 13.6739 8.37664C13.7892 8.42896 13.9139 8.45738 14.0405 8.46023C14.1671 8.46308 14.293 8.44031 14.4105 8.39324C14.5281 8.34616 14.6349 8.27576 14.7245 8.18632C14.8141 8.09688 14.8847 7.99029 14.932 7.87285C14.9794 7.7554 15.0024 7.62955 14.9998 7.50295C14.9972 7.37636 14.9691 7.25158 14.917 7.13616C14.8649 7.02074 14.79 6.91709 14.6968 6.83137L8.15325 0.273698L8.13777 0.26097C8.09883 0.223337 8.05691 0.188939 8.01238 0.158113C7.99829 0.14825 7.98132 0.142659 7.96723 0.134205C7.93028 0.110749 7.89171 0.090019 7.85173 0.0721977C7.82778 0.0623344 7.80241 0.0567106 7.77846 0.0496654C7.68837 0.0159749 7.59281 -0.000793911 7.49663 0.000300738C7.40046 -0.00246058 7.30467 0.0138159 7.21481 0.0482034C7.18804 0.0566576 7.15993 0.0623014 7.13457 0.0735737C7.10921 0.0848461 7.06968 0.107406 7.03868 0.124314C7.00768 0.141223 6.99505 0.145484 6.97392 0.159575C6.92351 0.193166 6.87629 0.231366 6.83296 0.273698L0.27529 6.81864C0.0992768 6.99428 0.000264777 7.23271 5.30097e-07 7.48137C-0.000263717 7.73002 0.0982745 7.9686 0.273914 8.14461C0.449554 8.32062 0.687897 8.41963 0.936553 8.4199C1.18521 8.42016 1.42378 8.32162 1.59979 8.14599L6.55544 3.20023L6.5385 18.9533C6.53831 19.0765 6.56244 19.1985 6.60945 19.3124C6.65645 19.4262 6.72538 19.5297 6.81241 19.6168C6.89944 19.704 7.00282 19.7731 7.1166 19.8203C7.23037 19.8675 7.35231 19.8918 7.47548 19.8918C7.72387 19.8914 7.96204 19.7925 8.13769 19.6169C8.31333 19.4413 8.41217 19.2032 8.41255 18.9548L8.4294 3.20169L13.3696 8.15588Z"
                            fill="#F4906E"
                        />
                    </svg>
                    Upload screenshot
                </label>
            )}
        </div>
    );
};

export default TrainingPaymentUploadScreenshot;
